<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>マイページ - Cat-box</title>
    <style>
        body { font-family: sans-serif; margin: 2em; }
        .user-info { background: #eef; padding: 1em; border-radius: 8px; }
        .logout-btn { margin-top: 1em; }
    </style>
</head>
<body>
    <h1>マイページ</h1>

    <div class="user-info">
        <p>ようこそ、<strong>{{ current_user.username }}</strong> さん！</p>
        <p>メールアドレス: {{ current_user.email }}</p>
        <p>現在のプラン: {{ current_user.plan }}</p>
        <p>保有ポイント: {{ current_user.points }} pt</p>
    </div>

    <div class="app-management">
        <h2>あなたのアプリ</h2>
        {% if current_user.apps %}
            <ul>
                {% for app in current_user.apps %}
                    <li>{{ app.name }} (v{{ app.version }})</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>まだ登録したアプリはありません。</p>
        {% endif %}
    </div>

    <hr style="margin: 2em 0;">

    <div class="app-upload-form">
        <h2>新しいアプリを登録する</h2>
        {% if upload_error %}
            <p style="color: red;">{{ upload_error }}</p>
        {% endif %}
        {% if upload_success %}
            <p style="color: green;">{{ upload_success }}</p>
        {% endif %}
        
        <form action="/mypage/apps/upload" method="post" enctype="multipart/form-data">
            <div style="margin-bottom: 1em;">
                <label for="name">アプリ名:</label><br>
                <input type="text" id="name" name="name" required>
            </div>
            <div style="margin-bottom: 1em;">
                <label for="version">バージョン:</label><br>
                <input type="text" id="version" name="version" placeholder="例: 1.0.0" required>
            </div>
            <div style="margin-bottom: 1em;">
                <label for="description">説明:</label><br>
                <textarea id="description" name="description" rows="4" style="width: 100%;"></textarea>
            </div>
            <div style="margin-bottom: 1em;">
                <label for="app_file">アプリファイル (.zip):</label><br>
                <input type="file" id="app_file" name="app_file" accept=".zip" required>
            </div>
            <button type="submit">アプリを登録する</button>
        </form>
    </div>

    <form action="/logout" method="post">
        <button type="submit" class="logout-btn">ログアウト</button>
    </form>
    
</body>
</html>